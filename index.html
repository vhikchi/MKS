<!DOCTYPE html>
<html lang="id" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TubeGen & ArtGen - AI Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: '#ef4444',
                        art: '#8b5cf6', 
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1f2937; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .transition-colors { transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1); }
        .loader { border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid currentColor; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Tab Animation */
        .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Refinement Select Style */
        .refine-select {
            background-color: #1f2937; 
            color: #e5e7eb;
            border: 1px solid #374151;
            font-size: 0.875rem;
            border-radius: 0.5rem;
            padding: 0.75rem;
            width: 100%;
            transition: all 0.2s;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
        }
        .refine-select:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.3);
        }
        
        /* Light mode override for select */
        .light .refine-select {
            background-color: #1f2937; /* Tetap gelap agar kontras */
            color: white;
        }

        .refine-custom-input {
            background-color: #374151;
            color: white;
            border: 1px solid #4b5563;
            font-size: 0.85rem;
            border-radius: 0.5rem;
            padding: 0.5rem;
            width: 100%;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 min-h-screen flex flex-col transition-colors relative">

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm px-4">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md p-6 border border-gray-200 dark:border-gray-700">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2">
                    <i class="fa-solid fa-gear text-gray-600 dark:text-gray-300"></i> Pengaturan API
                </h3>
                <button onclick="closeSettings()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-1">Google Gemini API Key</label>
                    <input type="password" id="modalApiKey" placeholder="Paste Key Anda (AIza...)" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-gray-50 dark:bg-gray-700 dark:text-white font-mono text-sm">
                    <p class="text-xs text-gray-500 mt-1">Key disimpan di Local Storage browser.</p>
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-1">Pilih Model AI</label>
                    <select id="modalModelSelect" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-gray-700 dark:text-white">
                        <option value="gemini-1.5-flash">Gemini 1.5 Flash (Stabil & Cepat)</option>
                        <option value="gemini-1.5-pro">Gemini 1.5 Pro (Reasoning Tinggi)</option>
                        <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (Experimental)</option>
                        <option value="gemini-2.5-flash-preview-09-2025">Gemini 2.5 Flash (Preview Terbaru)</option>
                        <option value="gemini-3.0-flash-exp">Gemini 3.0 (Experimental/Future)</option>
                    </select>
                </div>
            </div>
            <div class="mt-6 flex gap-3">
                <button onclick="saveSettings()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan</button>
                <button onclick="clearSettings()" class="px-4 py-2 border border-red-200 text-red-600 hover:bg-red-50 rounded-lg text-sm dark:border-red-900 dark:text-red-400">Hapus</button>
            </div>
        </div>
    </div>

    <!-- Navbar & Tabs -->
    <nav class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-2 mr-4">
                    <i class="fa-solid fa-robot text-blue-600 text-2xl"></i>
                    <span class="font-bold text-xl text-gray-800 dark:text-white hidden sm:inline">Creator<span class="text-blue-600">AI</span></span>
                </div>
                
                <!-- Tab Buttons -->
                <div class="flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 gap-1">
                    <button onclick="switchTab('youtube')" id="tabBtnYouTube" class="px-4 py-1.5 rounded-md text-sm font-semibold transition-all flex items-center gap-2 bg-white dark:bg-gray-600 shadow-sm text-red-600 dark:text-red-400">
                        <i class="fa-brands fa-youtube"></i> YouTube SEO
                    </button>
                    <button onclick="switchTab('image')" id="tabBtnImage" class="px-4 py-1.5 rounded-md text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all flex items-center gap-2">
                        <i class="fa-solid fa-image"></i> Image Prompt
                    </button>
                </div>
            </div>

            <div class="flex items-center gap-3">
                <button onclick="openSettings()" class="flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition border border-gray-300 dark:border-gray-600">
                    <i class="fa-solid fa-gear"></i>
                    <span id="apiStatusIndicator" class="w-2 h-2 rounded-full bg-red-500" title="API belum diset"></span>
                </button>
                <button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300 transition">
                    <i class="fa-solid fa-moon dark:hidden"></i>
                    <i class="fa-solid fa-sun hidden dark:inline"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto px-4 py-8 max-w-6xl">

        <!-- TAB 1: YOUTUBE SEO -->
        <div id="tabYouTube" class="tab-content active">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Left: Inputs -->
                <div class="lg:col-span-4 space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <h2 class="text-lg font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2">
                            <i class="fa-brands fa-youtube text-red-500"></i> Parameter YouTube
                        </h2>
                        <div class="space-y-5">
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Topik / Niche</label>
                                <input type="text" id="inputNiche" placeholder="Cth: Masakan Padang" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 outline-none bg-white dark:bg-gray-700 dark:text-white">
                            </div>
                            <!-- NEW KEYWORD INPUT -->
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Keywords (Kata Kunci)</label>
                                <input type="text" id="inputKeywords" placeholder="Cth: Resep mudah, Rendang, Pedas" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 outline-none bg-white dark:bg-gray-700 dark:text-white">
                                <p class="text-[10px] text-gray-400 mt-1">Pisahkan dengan koma. Wajib ada di judul jika diisi.</p>
                            </div>
                            
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Genre</label>
                                <select id="inputGenre" onchange="toggleCustomInput('inputGenre', 'customGenreWrapper')" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 outline-none bg-white dark:bg-gray-700 dark:text-white">
                                    <option value="Tutorial">Tutorial</option>
                                    <option value="Vlog">Vlog</option>
                                    <option value="Review">Review</option>
                                    <option value="Storytelling">Storytelling</option>
                                    <option value="Gaming">Gaming</option>
                                    <option value="Cinematic">Cinematic</option>
                                    <option value="Comedy">Comedy</option>
                                    <option value="Music">Music / Cover / AI</option>
                                    <option value="custom">Lainnya (Isi Sendiri)...</option>
                                </select>
                                <div id="customGenreWrapper" class="hidden mt-2">
                                    <input type="text" id="customGenreRaw" class="w-full px-4 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi genre...">
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Target Audience</label>
                                <select id="inputCountry" onchange="toggleCustomInput('inputCountry', 'customCountryWrapper')" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 outline-none bg-white dark:bg-gray-700 dark:text-white">
                                    <option value="Indonesia">Indonesia ðŸ‡®ðŸ‡©</option>
                                    <option value="USA">Global / USA ðŸ‡ºðŸ‡¸</option>
                                    <option value="Brazil">Brazil ðŸ‡§ðŸ‡·</option>
                                    <option value="Japan">Jepang ðŸ‡¯ðŸ‡µ</option>
                                    <option value="custom">Lainnya (Isi Sendiri)...</option>
                                </select>
                                <div id="customCountryWrapper" class="hidden mt-2">
                                    <input type="text" id="customCountryRaw" class="w-full px-4 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi target...">
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Emoticon</label>
                                    <select id="inputEmoticon" class="w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white">
                                        <option value="yes">âœ… Pakai</option>
                                        <option value="no">ðŸš« Tanpa</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Panjang</label>
                                    <select id="inputLength" class="w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white">
                                        <option value="short">Pendek (25-50)</option>
                                        <option value="medium" selected>Sedang (50-75)</option>
                                        <option value="long">Panjang (75-95)</option>
                                    </select>
                                </div>
                            </div>
                            <button onclick="generateYouTube()" id="btnYouTube" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg shadow-md flex justify-center items-center gap-2 transition">
                                <span class="btn-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></span>
                                <span class="btn-text">Generate YouTube Ideas</span>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Right: Results -->
                <div class="lg:col-span-8 space-y-6">
                    <div id="ytPromptResult" class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hidden">
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="text-lg font-bold text-gray-800 dark:text-white">ðŸ¤– System Prompt</h3>
                            <button onclick="copyToClipboard('ytGeneratedPrompt')" class="text-xs bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 p-2 rounded"><i class="fa-regular fa-copy"></i></button>
                        </div>
                        <textarea id="ytGeneratedPrompt" readonly class="w-full h-24 bg-gray-900 text-green-400 font-mono text-xs p-4 rounded-lg resize-none outline-none custom-scrollbar"></textarea>
                    </div>
                    <div id="ytResults" class="hidden space-y-6">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                            <h3 class="font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2"><i class="fa-solid fa-magnifying-glass-chart text-red-500"></i> 5 Judul SEO</h3>
                            <ul id="ytOutSeo" class="space-y-3"></ul>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                                <h3 class="font-bold text-gray-800 dark:text-white mb-4"><i class="fa-solid fa-fire text-yellow-500"></i> Viral Benchmark</h3>
                                <ul id="ytOutViral" class="space-y-3"></ul>
                            </div>
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                                <h3 class="font-bold text-gray-800 dark:text-white mb-4"><i class="fa-solid fa-music text-purple-500"></i> Audio Recs</h3>
                                <div id="ytOutAudio" class="flex flex-col gap-2"></div>
                            </div>
                        </div>
                    </div>
                    <div id="ytEmpty" class="flex flex-col items-center justify-center h-64 text-center text-gray-400 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl">
                        <i class="fa-brands fa-youtube text-5xl mb-4 opacity-50"></i>
                        <p>Siap Generate Ide YouTube</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: IMAGE PROMPT GENERATOR -->
        <div id="tabImage" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Left: Inputs -->
                <div class="lg:col-span-4 space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
                        <h2 class="text-lg font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-image text-purple-500"></i> Parameter Gambar
                        </h2>
                        <div class="space-y-5">
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Deskripsi Utama</label>
                                <textarea id="imgDesc" placeholder="Cth: Seorang astronot duduk di warung kopi futuristik..." class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none bg-white dark:bg-gray-700 dark:text-white h-24 resize-none"></textarea>
                            </div>
                            
                            <!-- Style Select with Custom -->
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Model / Style</label>
                                <select id="imgStyle" onchange="toggleCustomInput('imgStyle', 'customStyleWrapper')" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 dark:text-white">
                                    <option value="Photorealistic">Photorealistic / Cinematic</option>
                                    <option value="Anime">Anime / Manga Style</option>
                                    <option value="3D Render">3D Render (Pixar/Disney)</option>
                                    <option value="Oil Painting">Oil Painting</option>
                                    <option value="Cyberpunk">Cyberpunk / Neon</option>
                                    <option value="Minimalist">Minimalist</option>
                                    <option value="custom">Lainnya (Isi Sendiri)...</option>
                                </select>
                                <div id="customStyleWrapper" class="hidden mt-2">
                                    <input type="text" id="customStyleRaw" class="w-full px-4 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi style...">
                                </div>
                            </div>

                            <!-- Character Settings (Style & Age) -->
                            <div class="grid grid-cols-2 gap-4">
                                <!-- Character Style -->
                                <div>
                                    <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Character Style</label>
                                    <select id="imgCharStyle" onchange="toggleCustomInput('imgCharStyle', 'customCharStyleWrapper')" class="w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white">
                                        <option value="None">None (Default)</option>
                                        <option value="Sensual">Sensual / Alluring</option>
                                        <option value="Feminine">Feminine / Soft</option>
                                        <option value="Masculine">Masculine / Tough</option>
                                        <option value="Futuristic">Futuristic / Cyber</option>
                                        <option value="Old Style">Old Style / Vintage</option>
                                        <option value="Gothic">Gothic / Dark</option>
                                        <option value="Kawaii">Kawaii / Cute</option>
                                        <option value="custom">Lainnya...</option>
                                    </select>
                                    <div id="customCharStyleWrapper" class="hidden mt-2">
                                        <input type="text" id="customCharStyleRaw" class="w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi style...">
                                    </div>
                                </div>
                                <!-- Age Range -->
                                <div>
                                    <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Range Umur</label>
                                    <select id="imgAge" onchange="toggleCustomInput('imgAge', 'customAgeWrapper')" class="w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white">
                                        <option value="None">Abaikan / Pemandangan</option>
                                        <option value="Toddler">Balita (1-3 thn)</option>
                                        <option value="Child">Anak-anak (4-12 thn)</option>
                                        <option value="Teenager">Remaja (13-19 thn)</option>
                                        <option value="Young Adult">Dewasa Muda (20-30 thn)</option>
                                        <option value="Adult">Dewasa (30-50 thn)</option>
                                        <option value="Elderly">Lansia (60+ thn)</option>
                                        <option value="custom">Isi Sendiri...</option>
                                    </select>
                                    <div id="customAgeWrapper" class="hidden mt-2">
                                        <input type="text" id="customAgeRaw" class="w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Cth: 25 tahun...">
                                    </div>
                                </div>
                            </div>

                            <!-- Audience & Location with Custom -->
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Target Audience</label>
                                    <select id="imgAudience" onchange="toggleCustomInput('imgAudience', 'customAudienceWrapper')" class="w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white">
                                        <option value="General">General</option>
                                        <option value="Indonesia">Indonesia</option>
                                        <option value="Japan">Japan</option>
                                        <option value="Western">Western</option>
                                        <option value="custom">Lainnya...</option>
                                    </select>
                                    <div id="customAudienceWrapper" class="hidden mt-2">
                                        <input type="text" id="customAudienceRaw" class="w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi target...">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Lokasi</label>
                                    <select id="imgLocation" onchange="toggleCustomInput('imgLocation', 'customLocationWrapper')" class="w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white">
                                        <option value="Indoor">Indoor</option>
                                        <option value="Outdoor">Outdoor</option>
                                        <option value="Studio">Studio</option>
                                        <option value="Space">Space</option>
                                        <option value="custom">Lainnya...</option>
                                    </select>
                                    <div id="customLocationWrapper" class="hidden mt-2">
                                        <input type="text" id="customLocationRaw" class="w-full px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi lokasi...">
                                    </div>
                                </div>
                            </div>

                            <!-- AI Target with Custom -->
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Target AI Generator</label>
                                <select id="imgAiTarget" onchange="toggleCustomInput('imgAiTarget', 'customAiWrapper')" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 dark:text-white">
                                    <option value="Midjourney v6">Midjourney v6</option>
                                    <option value="DALL-E 3">DALL-E 3</option>
                                    <option value="Stable Diffusion XL">Stable Diffusion XL</option>
                                    <option value="Leonardo AI">Leonardo AI</option>
                                    <option value="Flux 1">Flux 1</option>
                                    <option value="custom">Lainnya (Isi Sendiri)...</option>
                                </select>
                                <div id="customAiWrapper" class="hidden mt-2">
                                    <input type="text" id="customAiRaw" class="w-full px-4 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-600 dark:text-white" placeholder="Isi AI model...">
                                </div>
                            </div>

                            <button onclick="generateImageRefinements()" id="btnImage" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg shadow-md flex justify-center items-center gap-2 transition">
                                <span class="btn-icon"><i class="fa-solid fa-palette"></i></span>
                                <span class="btn-text">Dapatkan Rekomendasi</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right: Output & Refinements -->
                <div class="lg:col-span-8 space-y-6">
                    
                    <!-- STEP 1: REFINEMENT / RECOMMENDATIONS (Select Based) -->
                    <div id="imgRefinementStep" class="hidden">
                        <div class="bg-gray-900 rounded-xl shadow-lg p-6 border border-gray-700">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                    <i class="fa-solid fa-sliders text-purple-400"></i> Langkah 4: Sesuaikan Prompt Anda
                                </h3>
                                <span class="text-xs bg-gray-800 text-gray-300 px-3 py-1 rounded-full border border-gray-600">AI Recommendations & Presets</span>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Function to create select block -->
                                <div id="blockAngle">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Angle</label>
                                    <select id="selAngle" class="refine-select" onchange="handleRefineChange('Angle')"></select>
                                    <input type="text" id="custAngle" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                                <div id="blockLighting">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Lighting</label>
                                    <select id="selLighting" class="refine-select" onchange="handleRefineChange('Lighting')"></select>
                                    <input type="text" id="custLighting" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                                <div id="blockComposition">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Composition</label>
                                    <select id="selComposition" class="refine-select" onchange="handleRefineChange('Composition')"></select>
                                    <input type="text" id="custComposition" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                                <div id="blockCamera">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Camera</label>
                                    <select id="selCamera" class="refine-select" onchange="handleRefineChange('Camera')"></select>
                                    <input type="text" id="custCamera" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                                <div id="blockBackground">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Background</label>
                                    <select id="selBackground" class="refine-select" onchange="handleRefineChange('Background')"></select>
                                    <input type="text" id="custBackground" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                                <div id="blockProps">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Props</label>
                                    <select id="selProps" class="refine-select" onchange="handleRefineChange('Props')"></select>
                                    <input type="text" id="custProps" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                                <div class="md:col-span-2" id="blockHair">
                                    <label class="block text-xs font-bold text-gray-400 mb-1">Hair Style / Detail</label>
                                    <select id="selHair" class="refine-select" onchange="handleRefineChange('Hair')"></select>
                                    <input type="text" id="custHair" class="hidden refine-custom-input" placeholder="Isi sendiri...">
                                </div>
                            </div>

                            <div class="mt-6">
                                <button onclick="finalizePrompt()" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-4 rounded-lg shadow-lg transition flex justify-center items-center gap-2">
                                    <i class="fa-solid fa-check-circle"></i> Dapatkan Prompt Final
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 2: FINAL RESULT -->
                    <div id="imgResultContainer" class="hidden bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-purple-200 dark:border-purple-900 p-6 relative overflow-hidden animation-fade-in">
                        <div class="absolute top-0 left-0 w-1 h-full bg-purple-500"></div>
                        <div class="flex justify-between items-end mb-2">
                            <h3 class="text-lg font-bold text-gray-800 dark:text-white">ðŸŽ¨ Prompt Result</h3>
                            <div class="flex gap-2">
                                <button onclick="editRefinement()" class="text-xs text-gray-500 hover:text-purple-600 underline mr-2">Edit Lagi</button>
                                <span class="text-xs bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 px-2 py-1 rounded" id="resAiTarget">Midjourney</span>
                            </div>
                        </div>
                        <div class="relative group">
                            <textarea id="imgFinalPrompt" class="w-full h-40 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4 text-sm text-gray-700 dark:text-gray-300 focus:ring-2 focus:ring-purple-500 outline-none resize-none transition-all" readonly></textarea>
                            <button onclick="copyToClipboard('imgFinalPrompt')" class="absolute top-2 right-2 bg-white dark:bg-gray-800 p-2 rounded shadow hover:bg-gray-100 dark:hover:bg-gray-700 transition text-gray-500"><i class="fa-regular fa-copy"></i></button>
                        </div>
                    </div>

                    <!-- Empty State -->
                    <div id="imgEmpty" class="flex flex-col items-center justify-center h-64 text-center text-gray-400 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl">
                        <i class="fa-solid fa-image text-5xl mb-4 opacity-50"></i>
                        <p>Masukkan deskripsi untuk memulai</p>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- GLOBAL CONFIG & STATIC DATA ---
        const CONFIG = { theme: 'light', activeTab: 'youtube' };
        let refinedSubject = ""; // Stores the AI rewritten subject description

        // Standar Options from User Request + General
        const STATIC_OPTIONS = {
            Angle: ["Wide shot capturing the entire scene", "Dynamic low-angle shot looking up", "Close-up on details", "Medium shot from behind", "Eye-level shot directly engaging"],
            Lighting: ["Dramatic three-point stage lighting", "Moody atmospheric lighting with shadows", "High-contrast backlighting (Silhouette)", "Dynamic colorful spotlights", "Ambient low-light setting", "Natural Golden Hour sunlight"],
            Composition: ["Rule of thirds", "Leading lines drawing the eye", "Symmetrical composition", "Deep depth of field (Sharp focus)", "Framing through foreground objects"],
            Camera: ["Sony Alpha a7S III with 24-70mm lens", "Canon EOS R5 with 50mm f/1.2 lens", "Nikon Z9 with 70-200mm lens", "Fujifilm GFX100S (Medium Format)", "Panasonic GH6 (Video-centric)", "35mm Film Camera Grain"],
            Background: ["Bustling environment with diverse crowd", "Abstract backdrop of lights/colors", "Dimly lit textured wall", "Futuristic glowing interface", "Minimalist solid color", "Nature landscape"],
            Props: ["Holding specific equipment", "Wearing accessories (glasses/hat)", "Smoke machine effects", "Technical gadgets/screens", "Everyday objects (coffee/book)"],
            Hair: ["Slightly disheveled but stylish", "Swept back or tied up", "Loose and flowing with highlights", "Short, edgy textured cut", "Wavy or curly with natural volume", "Bald / Shaved"]
        };

        // --- INIT ---
        window.onload = function() {
            loadSettings();
            if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            }
        }

        // --- UI HELPERS ---
        function switchTab(tabName) {
            CONFIG.activeTab = tabName;
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabName === 'youtube' ? 'tabYouTube' : 'tabImage').classList.add('active');

            const btnY = document.getElementById('tabBtnYouTube');
            const btnI = document.getElementById('tabBtnImage');
            const activeClass = ['bg-white', 'dark:bg-gray-600', 'shadow-sm', 'font-semibold'];
            const inactiveClass = ['text-gray-500', 'dark:text-gray-400', 'hover:text-gray-700', 'font-medium'];
            
            if(tabName === 'youtube') {
                btnY.classList.add(...activeClass, 'text-red-600', 'dark:text-red-400');
                btnY.classList.remove(...inactiveClass);
                btnI.classList.remove(...activeClass, 'text-purple-600', 'dark:text-purple-400');
                btnI.classList.add(...inactiveClass);
            } else {
                btnI.classList.add(...activeClass, 'text-purple-600', 'dark:text-purple-400');
                btnI.classList.remove(...inactiveClass);
                btnY.classList.remove(...activeClass, 'text-red-600', 'dark:text-red-400');
                btnY.classList.add(...inactiveClass);
            }
        }

        function toggleDarkMode() {
            const html = document.documentElement;
            if (html.classList.contains('dark')) {
                html.classList.remove('dark'); localStorage.setItem('theme', 'light');
            } else {
                html.classList.add('dark'); localStorage.setItem('theme', 'dark');
            }
        }
        
        function toggleCustomInput(selectId, wrapperId) {
            const select = document.getElementById(selectId);
            const wrapper = document.getElementById(wrapperId);
            if(select.value === 'custom') wrapper.classList.remove('hidden');
            else wrapper.classList.add('hidden');
        }

        function handleRefineChange(type) {
            const select = document.getElementById('sel' + type);
            const input = document.getElementById('cust' + type);
            if(select.value === 'custom') input.classList.remove('hidden');
            else input.classList.add('hidden');
        }

        function copyToClipboard(elementId) {
            const el = document.getElementById(elementId);
            el.select();
            document.execCommand('copy');
            const btn = el.nextElementSibling;
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-check"></i>';
            setTimeout(() => btn.innerHTML = original, 1500);
        }

        function setLoading(btnId, isLoading) {
            const btn = document.getElementById(btnId);
            const icon = btn.querySelector('.btn-icon');
            const text = btn.querySelector('.btn-text');
            if (isLoading) {
                icon.innerHTML = '<div class="loader"></div>';
                text.innerText = 'Thinking...';
                btn.disabled = true;
                btn.classList.add('opacity-75', 'cursor-not-allowed');
            } else {
                icon.innerHTML = btnId === 'btnYouTube' ? '<i class="fa-solid fa-wand-magic-sparkles"></i>' : '<i class="fa-solid fa-palette"></i>';
                text.innerText = btnId === 'btnYouTube' ? 'Generate YouTube Ideas' : 'Dapatkan Rekomendasi';
                btn.disabled = false;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        }

        // --- SETTINGS ---
        function openSettings() { document.getElementById('settingsModal').classList.remove('hidden'); loadSettings(); }
        function closeSettings() { document.getElementById('settingsModal').classList.add('hidden'); }
        function saveSettings() {
            const key = document.getElementById('modalApiKey').value.trim();
            const model = document.getElementById('modalModelSelect').value;
            if(key) {
                localStorage.setItem('yt_seo_api_key', key);
                localStorage.setItem('yt_seo_model', model);
                updateApiStatus(true);
                closeSettings();
            } else alert("API Key required");
        }
        function clearSettings() {
            localStorage.clear();
            document.getElementById('modalApiKey').value = '';
            updateApiStatus(false);
            closeSettings();
        }
        function loadSettings() {
            const key = localStorage.getItem('yt_seo_api_key');
            const model = localStorage.getItem('yt_seo_model');
            if(key) { document.getElementById('modalApiKey').value = key; updateApiStatus(true); }
            else updateApiStatus(false);
            if(model) document.getElementById('modalModelSelect').value = model;
        }
        function updateApiStatus(hasKey) {
            const ind = document.getElementById('apiStatusIndicator');
            ind.className = `w-2 h-2 rounded-full ${hasKey ? 'bg-green-500' : 'bg-red-500'}`;
            ind.title = hasKey ? 'API Ready' : 'No API Key';
        }

        // --- YOUTUBE LOGIC ---
        async function generateYouTube() {
            const niche = document.getElementById('inputNiche').value || "General";
            const keywords = document.getElementById('inputKeywords').value.trim(); // New Keyword
            let genre = document.getElementById('inputGenre').value;
            if(genre === 'custom') genre = document.getElementById('customGenreRaw').value || "General";
            let country = document.getElementById('inputCountry').value;
            if(country === 'custom') country = document.getElementById('customCountryRaw').value || "Global";
            const emoticon = document.getElementById('inputEmoticon').value;
            const length = document.getElementById('inputLength').value;

            setLoading('btnYouTube', true);
            
            const systemPrompt = `Act as a YouTube SEO Expert. 
            Niche: ${niche}.
            Keywords (Must Include): ${keywords || 'None'}. 
            Genre: ${genre}. 
            Target: ${country}. 
            Emoticon: ${emoticon}. 
            Length: ${length}. 
            
            Output JSON: { "system_prompt": "...", "seo_titles": [], "viral_benchmarks": [], "audio_recommendations": [] }`;

            const apiKey = localStorage.getItem('yt_seo_api_key');
            if(apiKey) {
                try {
                    const data = await callGeminiAPI(systemPrompt);
                    renderYouTube(data);
                } catch (e) {
                    alert("API Error: " + e.message);
                    simulateYouTube(niche);
                }
            } else {
                await new Promise(r => setTimeout(r, 1000));
                simulateYouTube(niche);
            }
            setLoading('btnYouTube', false);
        }

        function renderYouTube(data) {
            document.getElementById('ytEmpty').classList.add('hidden');
            document.getElementById('ytPromptResult').classList.remove('hidden');
            document.getElementById('ytResults').classList.remove('hidden');
            document.getElementById('ytGeneratedPrompt').value = data.system_prompt || "Prompt generated via AI";
            
            const seoUl = document.getElementById('ytOutSeo'); seoUl.innerHTML = '';
            (data.seo_titles || []).forEach((t, i) => seoUl.innerHTML += `<li class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded border border-gray-100 dark:border-gray-600 text-sm font-medium flex gap-3"><span class="text-gray-400 font-mono">0${i+1}</span> <span class="text-gray-800 dark:text-gray-200">${t}</span></li>`);

            const viralUl = document.getElementById('ytOutViral'); viralUl.innerHTML = '';
            (data.viral_benchmarks || []).forEach(t => viralUl.innerHTML += `<li class="flex justify-between p-2 border-l-4 border-yellow-500 bg-gray-50 dark:bg-gray-700 rounded-r text-sm"><a href="https://www.youtube.com/results?search_query=${encodeURIComponent(t)}&sp=CAMSAhAB" target="_blank" class="hover:text-yellow-600 dark:hover:text-yellow-400 truncate flex-1">"${t}"</a></li>`);

            const audioDiv = document.getElementById('ytOutAudio'); audioDiv.innerHTML = '';
            (data.audio_recommendations || []).forEach(s => audioDiv.innerHTML += `<a href="https://www.youtube.com/results?search_query=${encodeURIComponent(s)}" target="_blank" class="bg-purple-50 dark:bg-purple-900/30 p-2 rounded text-xs text-purple-800 dark:text-purple-200 border border-purple-100 dark:border-purple-800 hover:bg-purple-100 transition flex items-center gap-2"><i class="fa-solid fa-music"></i> ${s}</a>`);
        }

        function simulateYouTube(niche) {
            renderYouTube({
                system_prompt: "Simulated Prompt...",
                seo_titles: [`Rahasia ${niche} Terbongkar 2024 ðŸ”¥`, `Cara ${niche} Paling Mudah`, `Review Jujur: ${niche}`, `Jangan Lakukan Ini di ${niche}!`, `Tutorial ${niche} Lengkap`],
                viral_benchmarks: [`${niche} 100 Days`, `${niche} vs Mahal`, `${niche} ASMR`],
                audio_recommendations: ["Lofi Study Beats", "Trending TikTok Sound", "Cinematic Build Up"]
            });
        }

        // --- IMAGE GEN LOGIC ---
        async function generateImageRefinements() {
            const desc = document.getElementById('imgDesc').value.trim();
            if(!desc) { alert("Deskripsi tidak boleh kosong"); return; }

            const getVal = (id, wrapperId) => {
                const sel = document.getElementById(id);
                if(sel.value === 'custom') return document.getElementById(wrapperId).querySelector('input').value || "General";
                return sel.value;
            };

            const style = getVal('imgStyle', 'customStyleWrapper');
            const charStyle = getVal('imgCharStyle', 'customCharStyleWrapper');
            const ageRange = getVal('imgAge', 'customAgeWrapper'); // Ambil data umur
            const audience = getVal('imgAudience', 'customAudienceWrapper');
            const loc = getVal('imgLocation', 'customLocationWrapper');
            const aiTarget = getVal('imgAiTarget', 'customAiWrapper');

            setLoading('btnImage', true);
            document.getElementById('resAiTarget').innerText = aiTarget;
            document.getElementById('imgRefinementStep').classList.add('hidden');
            document.getElementById('imgResultContainer').classList.add('hidden');
            document.getElementById('imgEmpty').classList.add('hidden');

            // Updated System Prompt to request a Refined Subject
            const systemPrompt = `
            Role: Creative Director & Prompt Engineer.
            Task: Analyze user request: "${desc}". 
            Parameters: 
            - Style: ${style}
            - Character Vibe: ${charStyle}
            - Character Age: ${ageRange} (If 'None', ignore character specifics)
            - Context: ${audience}
            - Location: ${loc}
            
            Requirement 1: Rewrite the user's description into a highly detailed, professional visual subject description (field: 'Subject').
            Requirement 2: Provide SPECIFIC recommendations for technical aspects.
            
            Output JSON: { 
                "Subject": "Detailed, polished description...",
                "Angle": "...", 
                "Lighting": "...", 
                "Composition": "...", 
                "Camera": "...", 
                "Background": "...", 
                "Props": "...", 
                "Hair": "..." 
            }
            `;

            const apiKey = localStorage.getItem('yt_seo_api_key');
            if(apiKey) {
                try {
                    const data = await callGeminiAPI(systemPrompt);
                    refinedSubject = data.Subject; // Capture the AI rewritten subject
                    renderRefinementStep(data);
                } catch(e) {
                    console.error(e); alert("API Error. Using Simulation."); simulateRefinement();
                }
            } else {
                await new Promise(r => setTimeout(r, 1000)); simulateRefinement();
            }
            setLoading('btnImage', false);
        }

        function renderRefinementStep(aiData) {
            const categories = ['Angle', 'Lighting', 'Composition', 'Camera', 'Background', 'Props', 'Hair'];
            
            categories.forEach(cat => {
                const select = document.getElementById('sel' + cat);
                const customInput = document.getElementById('cust' + cat);
                
                select.innerHTML = '';
                customInput.classList.add('hidden');
                customInput.value = '';

                // 1. AI Recommendation
                const aiOption = document.createElement('option');
                aiOption.value = aiData[cat] || "";
                aiOption.text = `âœ¨ AI: ${aiData[cat] || "Standard"}`;
                aiOption.selected = true;
                select.appendChild(aiOption);

                // 2. Static Presets
                const presets = STATIC_OPTIONS[cat] || [];
                presets.forEach(p => {
                    const opt = document.createElement('option');
                    opt.value = p;
                    opt.text = p;
                    select.appendChild(opt);
                });

                // 3. Custom Option
                const custOpt = document.createElement('option');
                custOpt.value = "custom";
                custOpt.text = "âœŽ Isi Sendiri...";
                select.appendChild(custOpt);
            });

            document.getElementById('imgRefinementStep').classList.remove('hidden');
            document.getElementById('imgRefinementStep').scrollIntoView({behavior: 'smooth'});
        }

        function simulateRefinement() {
            // Simulated data includes Subject
            refinedSubject = "A cinematic portrait of a futuristic astronaut sitting in a neon-lit coffee shop";
            renderRefinementStep({
                Subject: refinedSubject,
                Angle: "Dynamic low-angle shot emphasizing power",
                Lighting: "Cinematic teal and orange with dramatic shadows",
                Composition: "Rule of thirds with subject off-center",
                Camera: "Sony A7R IV, 85mm f/1.4 GM",
                Background: "Blurred futuristic cityscape at night",
                Props: "Holding a glowing holographic device",
                Hair: "Windblown texture with neon highlights"
            });
        }

        function finalizePrompt() {
            const getRefineVal = (cat) => {
                const sel = document.getElementById('sel' + cat);
                if(sel.value === 'custom') return document.getElementById('cust' + cat).value;
                return sel.value;
            };

            const getVal = (id, wrapperId) => {
                const sel = document.getElementById(id);
                if(sel.value === 'custom') return document.getElementById(wrapperId).querySelector('input').value;
                return sel.value;
            };

            // Use the AI Refined Subject if available, otherwise fallback to raw input
            const baseDesc = refinedSubject ? refinedSubject : document.getElementById('imgDesc').value.trim();
            
            const style = getVal('imgStyle', 'customStyleWrapper');
            const charStyle = getVal('imgCharStyle', 'customCharStyleWrapper');
            const ageRange = getVal('imgAge', 'customAgeWrapper'); // Get Age
            const aiTarget = getVal('imgAiTarget', 'customAiWrapper');

            const angle = getRefineVal('Angle');
            const light = getRefineVal('Lighting');
            const comp = getRefineVal('Composition');
            const cam = getRefineVal('Camera');
            const bg = getRefineVal('Background');
            const props = getRefineVal('Props');
            const hair = getRefineVal('Hair');

            let prompt = `**${style}** image of ${baseDesc}. `;
            
            // Tambahkan detail karakter jika ada
            if (charStyle && charStyle !== 'None') prompt += `Character style: ${charStyle}. `;
            if (ageRange && ageRange !== 'None') prompt += `Subject age: ${ageRange}. `;
            
            if(props) prompt += `${props}, `;
            if(hair) prompt += `featuring ${hair}. `;
            if(bg) prompt += `Set in ${bg}. `;
            prompt += `\n\nTechnique: ${angle}, ${comp}. Lighting: ${light}. \nShot on ${cam}. High fidelity, 8k resolution, masterpiece.`;

            if(aiTarget.includes("Midjourney")) prompt += " --v 6.0 --style raw";
            else if(aiTarget.includes("Niji")) prompt += " --niji 6";

            document.getElementById('imgResultContainer').classList.remove('hidden');
            document.getElementById('imgFinalPrompt').value = prompt;
            document.getElementById('imgResultContainer').scrollIntoView({behavior: 'smooth'});
        }

        function editRefinement() {
            document.getElementById('imgResultContainer').classList.add('hidden');
            document.getElementById('imgRefinementStep').scrollIntoView({behavior: 'smooth'});
        }

        async function callGeminiAPI(prompt) {
            const key = localStorage.getItem('yt_seo_api_key');
            const model = localStorage.getItem('yt_seo_model') || 'gemini-1.5-flash';
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${key}`;
            const response = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }) });
            const raw = await response.json();
            if(!response.ok) throw new Error(raw.error?.message || "Failed");
            return JSON.parse(raw.candidates[0].content.parts[0].text.replace(/```json/g, '').replace(/```/g, '').trim());
        }
    </script>
</body>
</html>
